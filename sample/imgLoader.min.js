function imgLoader(e){function t(e){if(c=e.target.files[0].type,o.indexOf(c)===-1)return console.error("Unsupported file format");var t=new FileReader;t.onload=function(e){var t=new Image;t.onload=a,t.src=e.target.result},t.readAsDataURL(e.target.files[0])}function a(t){var a=t.target;g=document.createElement("canvas"),h=g.getContext("2d"),r=document.createElement("canvas"),m=r.getContext("2d");for(var n=0;n<e.templates.length;n++)i(a,e.templates[n]),g.width=0,g.height=0,r.width=0,r.height=0;e.callback&&e.callback(l)}function i(e,t){if(!l[t.id]){var a=Object.create(s);a.template=t,a.canvas=document.createElement("canvas"),a.ctx=a.canvas.getContext("2d"),t.displayElementId&&document.getElementById(t.displayElementId).appendChild(a.canvas),l[t.id]=a}l[t.id].inputType=c;var i=n(e.width,e.height,t.width,t.height),d=e;if(i.width<e.width/2){var o=e.width,p=e.height;do o=.5*o,p=.5*p,r.width=o,r.height=p,m.drawImage(d,0,0,o,p),d=g,g.width=o,g.height=p,h.drawImage(r,0,0,o,p);while(o>=2*i.width)}l[t.id].canvas.width=i.width,l[t.id].canvas.height=i.height,l[t.id].ctx.drawImage(d,0,0,i.width,i.height)}function n(e,t,a,i){if(e<=a&&t<=i)return{width:e,height:t};var n=e,d=t;return e>t?(n=a,d=a/e*t):(n=i/t*e,d=i),n>a&&(n=a,d=a/e*t),d>i&&(n=i/t*e,d=i),{width:n,height:d}}var d,g,h,r,m,c,l={},o=["image/png","image/jpeg","image/gif","image/bmp","image/svg+xml","image/x-icon","image/webp"];if(!e.inputId||!e.templates||e.templates.length<1)return console.error("You must specify the id of a file input element and at least one job template");d=document.getElementById(e.inputId),d.addEventListener("change",t);var s={getImage:function(e,t){return e||(e="image/png"==this.inputType?"image/png":"image/jpeg"),this.canvas.toDataURL(e,t)}}}